src() {
    local mode=""
    local file=""

    while [[ "$#" -gt 0 ]]; do
        case "$1" in
            -f|--file)
                mode="file"
                file="$2"
                shift 2
                ;;
            -c|--cmd)
                mode="cmd"
                file="$2"
                shift 2
                ;;
            -x|--executable)
                mode="executable"
                file="$2"
                shift 2
                ;;
            -h|--help)
                echo "Usage: src [options] <file>"
                echo "Options:"
                echo "  -f, --file        Source file if it exists"
                echo "  -c, --cmd         Source command's init file if command exists"
                echo "  -x, --executable  Source file if it is executable"
                echo "  -h, --help        Show this help message"
                return 0
                ;;
            *)
                echo "Unknown option: $1"
                return 1
                ;;
        esac
    done

    if [[ -z "$file" ]]; then
        echo "No file specified"
        return 1
    fi

    case "$mode" in
        file)
            if [[ -f "$file" ]]; then
                source "$file"
            else
                echo "File not found: $file"
                return 1
            fi
            ;;
        cmd)
            if command -v "$file" > /dev/null 2>&1; then
                # For commands, we typically source their init files
                # This is safer than arbitrary eval
                echo "Command exists: $file"
                echo "Note: Use 'source' directly to load configuration files"
            else
                echo "Command not found: $file"
                return 1
            fi
            ;;
        executable)
            if [[ -x "$file" ]]; then
                source "$file"
            else
                echo "File is not executable: $file"
                return 1
            fi
            ;;
        *)
            echo "No mode specified"
            return 1
            ;;
    esac
}
